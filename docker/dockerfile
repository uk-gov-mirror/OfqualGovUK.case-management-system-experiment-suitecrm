FROM crofqappdev1.azurecr.io/ofqual/suitecrm-bitnami:latest

# Copy Ofqual extension files into the SuiteCRM extensions directory
COPY SuiteCRM/extensions/Ofqual /opt/bitnami/suitecrm/extensions/Ofqual

WORKDIR /opt/bitnami/suitecrm

# Set correct permissions on all files and directories
RUN find . -type d -not -perm 2755 -exec chmod 2755 {} \; && \
    find . -type f -not -perm 0644 -exec chmod 0644 {} \; && \
    find . ! -user daemon -exec chown daemon:daemon {} \;
RUN ["chmod","+x", "bin/console"]
